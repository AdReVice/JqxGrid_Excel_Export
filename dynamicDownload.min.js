/* created and modified by Manish Joshi
 * github : www.github.com/adrevice
 * Do Not Copy
*/
// Blob Data
!function(t){"use strict";if(t.URL=t.URL||t.webkitURL,t.Blob&&t.URL)try{return void new Blob}catch(t){}var e=t.BlobBuilder||t.WebKitBlobBuilder||t.MozBlobBuilder||function(t){var e=function(t){return Object.prototype.toString.call(t).match(/^\[object\s(.*)\]$/)[1]},n=function(){this.data=[]},o=function(t,e,n){this.data=t,this.size=t.length,this.type=e,this.encoding=n},i=n.prototype,a=o.prototype,r=t.FileReaderSync,c=function(t){this.code=this[this.name=t]},s="NOT_FOUND_ERR SECURITY_ERR ABORT_ERR NOT_READABLE_ERR ENCODING_ERR NO_MODIFICATION_ALLOWED_ERR INVALID_STATE_ERR SYNTAX_ERR".split(" "),d=s.length,l=t.URL||t.webkitURL||t,u=l.createObjectURL,R=l.revokeObjectURL,f=l,h=t.btoa,p=t.atob,b=t.ArrayBuffer,g=t.Uint8Array;for(o.fake=a.fake=!0;d--;)c.prototype[s[d]]=d+1;return l.createObjectURL||(f=t.URL={}),f.createObjectURL=function(t){var e,n=t.type;return null===n&&(n="application/octet-stream"),t instanceof o?(e="data:"+n,"base64"===t.encoding?e+";base64,"+t.data:"URI"===t.encoding?e+","+decodeURIComponent(t.data):h?e+";base64,"+h(t.data):e+","+encodeURIComponent(t.data)):u?u.call(l,t):void 0},f.revokeObjectURL=function(t){"data:"!==t.substring(0,5)&&R&&R.call(l,t)},i.append=function(t){var n=this.data;if(g&&(t instanceof b||t instanceof g)){for(var i="",a=new g(t),s=0,d=a.length;s<d;s++)i+=String.fromCharCode(a[s]);n.push(i)}else if("Blob"===e(t)||"File"===e(t)){if(!r)throw new c("NOT_READABLE_ERR");var l=new r;n.push(l.readAsBinaryString(t))}else t instanceof o?"base64"===t.encoding&&p?n.push(p(t.data)):"URI"===t.encoding?n.push(decodeURIComponent(t.data)):"raw"===t.encoding&&n.push(t.data):("string"!=typeof t&&(t+=""),n.push(unescape(encodeURIComponent(t))))},i.getBlob=function(t){return arguments.length||(t=null),new o(this.data.join(""),t,"raw")},i.toString=function(){return"[object BlobBuilder]"},a.slice=function(t,e,n){var i=arguments.length;return i<3&&(n=null),new o(this.data.slice(t,i>1?e:this.data.length),n,this.encoding)},a.toString=function(){return"[object Blob]"},a.close=function(){this.size=this.data.length=0},n}(t);t.Blob=function(t,n){var o=n&&n.type||"",i=new e;if(t)for(var a=0,r=t.length;a<r;a++)i.append(t[a]);return i.getBlob(o)}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content||this);
//file Saver Implementation
var saveAs=saveAs||"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob.bind(navigator)||function(e){"use strict";if("undefined"==typeof navigator||!/MSIE [1-9]\./.test(navigator.userAgent)){var t=e.document,n=e.URL||e.webkitURL||e,o=t.createElementNS("http://www.w3.org/1999/xhtml","a"),r=!e.externalHost&&"download"in o,i=e.webkitRequestFileSystem,a=e.requestFileSystem||i||e.mozRequestFileSystem,s=function(t){(e.setImmediate||e.setTimeout)(function(){throw t},0)},d=0,u=[],c=function(){for(var e=u.length;e--;){var t=u[e];"string"==typeof t?n.revokeObjectURL(t):t.remove()}u.length=0},f=function(e,t,n){for(var o=(t=[].concat(t)).length;o--;){var r=e["on"+t[o]];if("function"==typeof r)try{r.call(e,n||e)}catch(e){s(e)}}},l=function(n,s){var c,l,v,w=this,p=n.type,A=!1,S=function(){var t=(e.URL||e.webkitURL||e).createObjectURL(n);return u.push(t),t},E=function(){f(w,"writestart progress write writeend".split(" "))},y=function(){if(!A&&c||(c=S()),!l){if(navigator.userAgent.match(/7\.[\d\s\.]+Safari/)&&void 0!==window.FileReader&&n.size<=157286400){var e=new window.FileReader;return e.readAsDataURL(n),e.onloadend=function(){var n=t.createElement("iframe");n.src=e.result,n.style.display="none",t.body.appendChild(n),E()},w.readyState=w.DONE,void(w.savedAs=w.SAVEDASUNKNOWN)}return window.open(c,"_blank"),w.readyState=w.DONE,w.savedAs=w.SAVEDASBLOB,void E()}l.location.href=c},m=function(e){return function(){if(w.readyState!==w.DONE)return e.apply(this,arguments)}},h={create:!0,exclusive:!1};if(w.readyState=w.INIT,s||(s="download"),r){c=S(),t=e.document,(o=t.createElementNS("http://www.w3.org/1999/xhtml","a")).href=c,o.download=s;var O=t.createEvent("MouseEvents");return O.initMouseEvent("click",!0,!1,e,0,0,0,0,0,!1,!1,!1,!1,0,null),o.dispatchEvent(O),w.readyState=w.DONE,w.savedAs=w.SAVEDASBLOB,void E()}e.chrome&&p&&"application/octet-stream"!==p&&(v=n.slice||n.webkitSlice,n=v.call(n,0,n.size,"application/octet-stream"),A=!0),i&&"download"!==s&&(s+=".download"),("application/octet-stream"===p||i)&&(l=e),a?(d+=n.size,a(e.TEMPORARY,d,m(function(e){e.root.getDirectory("saved",h,m(function(e){var t=function(){e.getFile(s,h,m(function(e){e.createWriter(m(function(t){t.onwriteend=function(t){l.location.href=e.toURL(),u.push(e),w.readyState=w.DONE,w.savedAs=w.SAVEDASBLOB,f(w,"writeend",t)},t.onerror=function(){var e=t.error;e.code!==e.ABORT_ERR&&y()},"writestart progress write abort".split(" ").forEach(function(e){t["on"+e]=w["on"+e]}),t.write(n),w.abort=function(){t.abort(),w.readyState=w.DONE,w.savedAs=w.FAILED},w.readyState=w.WRITING}),y)}),y)};e.getFile(s,{create:!1},m(function(e){e.remove(),t()}),m(function(e){e.code===e.NOT_FOUND_ERR?t():y()}))}),y)}),y)):y()},v=l.prototype,w=function(e,t){return new l(e,t)};return v.abort=function(){this.readyState=this.DONE,this.savedAs=this.FAILED,f(this,"abort")},v.readyState=v.INIT=0,v.WRITING=1,v.DONE=2,v.FAILED=-1,v.SAVEDASBLOB=1,v.SAVEDASURI=2,v.SAVEDASUNKNOWN=3,v.error=v.onwritestart=v.onprogress=v.onwrite=v.onabort=v.onerror=v.onwriteend=null,e.addEventListener("unload",c,!1),w.unload=function(){c(),e.removeEventListener("unload",c,!1)},w}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);"undefined"!=typeof module&&null!==module?module.exports=saveAs:"undefined"!=typeof define&&null!==define&&null!=define.amd?define([],function(){return saveAs}):"undefined"!=typeof Meteor&&(Meteor.saveAs=saveAs);
// custome
var Jhxlsx={config:{fileName:"report",extension:".xlsx",sheetName:"Sheet",fileFullName:"report.xlsx",header:!0,createEmptyRow:!0,maxCellWidth:20},worksheetObj:{},rowCount:0,wsColswidth:[],merges:[],worksheet:{},range:{},init:function(t){if(this.reset(),t)for(var e in this.config)t.hasOwnProperty(e)&&(this.config[e]=t[e]);this.config.fileFullName=this.config.fileName+this.config.extension},reset:function(){this.range={s:{c:1e7,r:1e7},e:{c:0,r:0}},this.worksheetObj={},this.rowCount=0,this.wsColswidth=[],this.merges=[],this.worksheet={}},parse2Int0:function(t){return t=parseInt(t),t=customeIsNAN(t)?0:t},cellWidth:function(t,e){var s=t&&1.3*t.length;this.wsColswidth[e]?s>this.wsColswidth[e].wch&&(this.wsColswidth[e]={wch:s}):this.wsColswidth[e]={wch:s}},cellWidthValidate:function(){for(var t in this.wsColswidth)this.wsColswidth[t].wch>this.config.maxCellWidth&&(this.wsColswidth[t].wch=this.config.maxCellWidth)},datenum:function(t,e){return e&&(t+=1462),(Date.parse(t)-new Date(Date.UTC(1899,11,30)))/864e5},setCellDataType:function(t){"number"==typeof t.v?t.t="n":"boolean"==typeof t.v?t.t="b":t.v instanceof Date?(t.t="n",t.z=XLSX.SSF._table[14],t.v=this.datenum(t.v)):t.t="s"},jhAddRow:function(t){for(var e in t){var s=t[e=this.parse2Int0(e)];this.range.s.r>this.rowCount&&(this.range.s.r=this.rowCount),this.range.s.c>e&&(this.range.s.c=e),this.range.e.r<this.rowCount&&(this.range.e.r=this.rowCount),this.range.e.c<e&&(this.range.e.c=e);var i=null;s.hasOwnProperty("text")&&(i=s.text);var r={v:i},h=!0;if(s.hasOwnProperty("merge")){var o=s.merge;h=!1;var n=e,a=this.rowCount;o.hasOwnProperty("c")&&(n=e+parseInt(o.c)),o.hasOwnProperty("r")&&(a=this.rowCount+parseInt(o.r)),this.merges.push({s:{r:this.rowCount,c:e},e:{r:a,c:n}})}if(h&&this.cellWidth(r.v,e),null!==r.v){var w=XLSX.utils.encode_cell({c:e,r:this.rowCount});this.setCellDataType(r),s.hasOwnProperty("style")&&(r.s=s.style),this.worksheet[w]=r}}this.rowCount++},createWorkSheet:function(){for(var t in this.worksheetObj.data)this.jhAddRow(this.worksheetObj.data[t]);return this.cellWidthValidate(),this.worksheet["!merges"]=this.merges,this.worksheet["!cols"]=this.wsColswidth,this.range.s.c<1e7&&(this.worksheet["!ref"]=XLSX.utils.encode_range(this.range)),this.worksheet},s2ab:function(t){for(var e=new ArrayBuffer(t.length),s=new Uint8Array(e),i=0;i!=t.length;++i)s[i]=255&t.charCodeAt(i);return e},getBlob:function(t,e){this.init(e);var s=new Workbook;for(var i in t){this.reset(),this.worksheetObj=t[i];var r=this.config.sheetName+i;this.worksheetObj.hasOwnProperty("sheetName")&&(r=this.worksheetObj.sheetName),this.createWorkSheet(),s.SheetNames.push(r),s.Sheets[r]=this.worksheet}var h=XLSX.write(s,{bookType:"xlsx",bookSST:!0,type:"binary"});return new Blob([this.s2ab(h)],{type:"application/octet-stream"})},export:function(t,e){saveAs(this.getBlob(t,e),this.config.fileFullName)}};function Workbook(){if(!(this instanceof Workbook))return new Workbook;this.SheetNames=[],this.Sheets={}};function customeIsNAN(n){return!(null!=n&&"number"==typeof n)};
//download Method
function dynDownload(e,r,l){$(r).jqxGrid("showloadelement");var n=new Array,t=$(r).jqxGrid("columns"),c=$(r).jqxGrid("getrows");if(c.length>0){for(var d="[[",a=e,o=0,f=0;f<t.records.length;f++){if(1!=t.records[f].hidden&&!checkIfInclude(t.records[f].datafield,a))d+='{ "style": {"font": {"bold": true } },"text":"'+t.records[f].text.replace("<br>","")+'"}',n[o++]=t.records[f].datafield,d+=","}d=d.replace(/,([^,]*)$/,"$1"),d+="],";for(f=0;f<c.length;f++){for(var i="[",h=0;h<n.length;h++){var u=n[h];i+='{"text":"'+(checkIfNullOrUndefined(c[f][u])?"":c[f][u].replace(/(\r\n|\n|\r)/gm," ").replace(/[^\u0000-\u007F]+/g,"").replace(/"/g,"'").replace(/\\/g,"\\\\").replace("&","and").replace(/\s+/g," ").trim())+'"}',h!=n.length-1&&(i+=",")}i+="]",f!=c.length-1&&(i+=","),d+=i}exportExcel(d+="]",l)}$(r).jqxGrid("hideloadelement")}function exportExcel(e,r){var l={fileName:r};var n=[{sheetName:"Sheet1",data:JSON.parse(e)}];Jhxlsx.export(n,l)}function checkIfNullOrUndefined(e){return void 0===e||null==e}function checkIfInclude(e,r){var l=!1;return-1!==r.indexOf(e)&&(l=!0),l}